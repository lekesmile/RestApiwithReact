<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Restful Api</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <hi>Ninja Api</hi>
    <div id="homepahe">
        <h1>Hire a Ninja</h1>
        <div id="ninjas" ></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.24.0/babel.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.1.0/react.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.1.0/react-dom.min.js"></script>

<script type="text/babel">

const Ninjas = React.createClass({
    getInitialState: ()=>{
        return({
            ninjas:[]
        });
    },
    render:()=>{
        const ninjas = this.State.ninjas;
        ninjas = ninjas.map((ninja, index)=>{
            return(
                <li key ={index}>
                <span className = {ninja.obj.available}></span>
                <span className = "name"> {ninja.obj.name}</span>
                <span className = "rank"> {ninja.obj.rank}</span>
                <span className = "dist"> {Math.floor(ninja.dis/1000)} km </span>
            
                </li>
            );
        });
        return(
            <div>
                <form onSubmit={this.handleSubmit}>
                    <label for="">Enter your latitude</label>
                    <input type="text" ref = "lat" placeholder="latitude" required /> 
                    <label for="">Enter your longitude</label>
                    <input type="text" ref = "lng" placeholder="longitude" required />
                    <input type="submit" value="Find Ninja"/>
                </form>

                <ul>{ninjas}</ul>
            </div>
        );
    },

    handleSubmit:function(e){
        e.preventDefault();

    var lng = this.refs.lng.value;
    var lat = this.refs.lat.value;

    fetch('api/ninjas?lng =' + lng + '&lat=' + lat).then((data)=>{
      return data.json();
    }).then((json)=>{
        this.setState({
            ninjas:json
        });
    });
    }
});


ReactDOM.render(<Ninjas/>, document.getElementById('ninjas'))
</script>

</body>
</html>